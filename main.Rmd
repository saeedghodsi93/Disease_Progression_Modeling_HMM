---
title: "Disease Progression Modeling using HMMs"
author: "Saeed Ghodsi"
header-includes:
   - \usepackage{bbm}
   - \usepackage{url}
   - \usepackage{booktabs}
   - \usepackage{amsfonts}
   - \usepackage{nicefrac}
   - \usepackage{microtype}
   - \usepackage{xcolor}
   - \usepackage{ae,aecompl}
   - \usepackage{color}
   - \usepackage{babel}
   - \usepackage{booktabs}
   - \usepackage{mathrsfs}
   - \usepackage{bbm}
   - \usepackage{xcolor}
   - \usepackage{amsmath}
   - \usepackage{amsthm}
   - \usepackage{mathtools}
   - \usepackage{amsfonts}
   - \usepackage{graphicx}
   - \usepackage{subfig}
   - \usepackage{setspace}
   - \usepackage{perpage}
   - \usepackage{comment}
   - \allowdisplaybreaks
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# add the libraries
library(MASS)
library(reticulate)
library(xtable)
library(tidyverse)
library(tinytex)
library(ggplot2)
library(plotly) 
library(reshape2)
library(graphics)
library(AER)
library(expm)
library(FNN)
library(msm)
library(cthmm)
library(hmm.discnp)

# add the R files
source("CTHMM/setup.R")
source("CTHMM/debugging.R")
source("CTHMM/set_parameters.R")
source("CTHMM/data_generation.R")
source("CTHMM/forward_backward.R")
source("CTHMM/end_conditioned_expectations.R")
source("CTHMM/e_step.R")
source("CTHMM/m_step.R")
source("CTHMM/em_algorithm.R")
source("CTHMM/cthmm.R")

# call the initial setup function
setup.func()

# add the Python files
source_python("CTHMM/visualization.py")

```

Analyze the CTHMM model:

```{r, echo = TRUE, warning = FALSE}

run.algorithm <- FALSE
debugging.mode <- FALSE
latex.table <- FALSE
ret.cthmm <- cthmm.func(run.algorithm, debugging.mode, latex.table)
I <- ret.cthmm$I
J <- ret.cthmm$J
L <- ret.cthmm$L
N.vals <- ret.cthmm$N.vals
pi <- ret.cthmm$pi
Q <- ret.cthmm$Q
mu <- ret.cthmm$mu
eta <- ret.cthmm$eta
pi.hat.vals <- ret.cthmm$pi.hat.vals
Q.hat.vals <- ret.cthmm$Q.hat.vals
mu.hat.vals <- ret.cthmm$mu.hat.vals
eta.hat.vals <- ret.cthmm$eta.hat.vals

```

